# -*- shell-script -*-

ORIG=${SDIR}/build
SRC=$(cd $(dirname $0); pwd)

function restore_apt_repo {
    local dir=$1
    echo "" > $dir/etc/apt/sources.list
    rm $dir/etc/apt/sources.list.d/wheezy-backport.list
    rm $dir/etc/apt/sources.list.d/nonfree.list
    repository="http://cdn.debian.net/debian"
    echo "deb http://security.debian.org/ wheezy/updates main" > $dir/etc/apt/sources.list.d/updates.list
    echo "deb $repository wheezy-updates main" >> $dir/etc/apt/sources.list.d/updates.list  
    echo "deb $repository wheezy main" > $dir/etc/apt/sources.list
    echo "deb $repository wheezy-backports main" > $dir/etc/apt/sources.list.d/wheezy-backport.list
}

function pin_local {
    local dist=$1
    local dir=$2
    local priority=$3

    check_usage $# 3 "pin_repository <dist> <chroot> <priority>"

    if [ ! -z "${priority}" ];then
        case "$dist" in
            $supported_debian_dists|$supported_ubuntu_dists)
                cat >> $dir/etc/apt/preferences <<EOF

Package: *
Pin: origin ""
Pin-Priority: $priority

EOF
        esac
    fi
}

. ${ORIG}/functions
